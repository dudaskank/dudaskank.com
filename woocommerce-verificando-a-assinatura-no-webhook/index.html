<!DOCTYPE html><html lang="pt-br"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Woocommerce - Verificando a assinatura no Webhook - Blog do Duda</title><meta name="description" content="Nos últimos tempos, tenho trabalhado bastante com PHP e em alguns projetos escolhi usar o WordPress, que já uso aqui no blog, estou habituado e é relativamente fácil conseguir material sobre ele na internet. Desses projetos, um deles é uma loja virtual, e comecei a conhecer&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="stylesheet" href="https://dudaskank.com/media/plugins/syntaxHighlighter/prism-black.css"><link rel="canonical" href="https://dudaskank.com/woocommerce-verificando-a-assinatura-no-webhook/"><link rel="alternate" type="application/atom+xml" href="https://dudaskank.com/feed.xml" title="Blog do Duda - RSS"><link rel="alternate" type="application/json" href="https://dudaskank.com/feed.json" title="Blog do Duda - JSON"><meta property="og:title" content="Woocommerce - Verificando a assinatura no Webhook"><meta property="og:image" content="https://dudaskank.com/media/posts/12/outgoing-webhook_512-2.png"><meta property="og:image:width" content="512"><meta property="og:image:height" content="512"><meta property="og:site_name" content="Blog do Duda"><meta property="og:description" content="Nos últimos tempos, tenho trabalhado bastante com PHP e em alguns projetos escolhi usar o WordPress, que já uso aqui no blog, estou habituado e é relativamente fácil conseguir material sobre ele na internet. Desses projetos, um deles é uma loja virtual, e comecei a conhecer&hellip;"><meta property="og:url" content="https://dudaskank.com/woocommerce-verificando-a-assinatura-no-webhook/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@dudaskank"><meta name="twitter:title" content="Woocommerce - Verificando a assinatura no Webhook"><meta name="twitter:description" content="Nos últimos tempos, tenho trabalhado bastante com PHP e em alguns projetos escolhi usar o WordPress, que já uso aqui no blog, estou habituado e é relativamente fácil conseguir material sobre ele na internet. Desses projetos, um deles é uma loja virtual, e comecei a conhecer&hellip;"><meta name="twitter:image" content="https://dudaskank.com/media/posts/12/outgoing-webhook_512-2.png"><link rel="stylesheet" href="https://dudaskank.com/assets/css/style.css?v=2110fdcc9616a96348b5f5ad11c64055"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://dudaskank.com/woocommerce-verificando-a-assinatura-no-webhook/"},"headline":"Woocommerce - Verificando a assinatura no Webhook","datePublished":"2016-08-30T15:25-03:00","dateModified":"2026-02-23T11:23-03:00","image":{"@type":"ImageObject","url":"https://dudaskank.com/media/posts/12/outgoing-webhook_512-2.png","height":512,"width":512},"description":"Nos últimos tempos, tenho trabalhado bastante com PHP e em alguns projetos escolhi usar o WordPress, que já uso aqui no blog, estou habituado e é relativamente fácil conseguir material sobre ele na internet. Desses projetos, um deles é uma loja virtual, e comecei a conhecer&hellip;","author":{"@type":"Person","name":"Dudaskank","url":"https://dudaskank.com/authors/dudaskank/"},"publisher":{"@type":"Organization","name":"Dudaskank"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><header class="top js-header"><a class="logo" href="https://dudaskank.com/">Blog do Duda</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://dudaskank.com/" target="_self">Artigos</a></li><li><a href="https://dudaskank.com/tags/" target="_self">Tags</a></li></ul></nav></header><main class="post"><article class="content"><div class="hero"><header class="hero__content"><div class="wrapper"><h1>Woocommerce - Verificando a assinatura no Webhook</h1><div class="feed__meta content__meta"><a href="https://dudaskank.com/authors/dudaskank/" class="feed__author">Dudaskank</a> <time datetime="2016-08-30T15:25" class="feed__date">30/08/2016</time></div></div></header><figure class="hero__image"><div class="hero__image-wrapper"><img src="https://dudaskank.com/media/posts/12/outgoing-webhook_512-2.png" srcset="https://dudaskank.com/media/posts/12/responsive/outgoing-webhook_512-2-xs.png 640w, https://dudaskank.com/media/posts/12/responsive/outgoing-webhook_512-2-sm.png 768w, https://dudaskank.com/media/posts/12/responsive/outgoing-webhook_512-2-md.png 1024w, https://dudaskank.com/media/posts/12/responsive/outgoing-webhook_512-2-lg.png 1366w, https://dudaskank.com/media/posts/12/responsive/outgoing-webhook_512-2-xl.png 1600w, https://dudaskank.com/media/posts/12/responsive/outgoing-webhook_512-2-2xl.png 1920w" sizes="88vw" loading="eager" height="512" width="512" alt=""></div></figure></div><div class="entry-wrapper content__entry"><p>Nos últimos tempos, tenho trabalhado bastante com PHP e em alguns projetos escolhi usar o <a href="http://wordpress.org/" target="_blank" rel="noopener">WordPress</a>, que já uso aqui no blog, estou habituado e é relativamente fácil conseguir material sobre ele na internet. Desses projetos, um deles é uma loja virtual, e comecei a conhecer e utilizar o famoso plugin do <a href="https://woocommerce.com/" target="_blank" rel="noopener">WooCommerce</a>, que transforma seu WordPress em uma loja virtual totalmente funcional. Nesse projeto, surgiu a necessidade de quando ocorrer determinados eventos na loja, como a criação do pedido, comunicar o evento para um outro sistema. Foi aí que descobri a existência dos <a href="https://docs.woocommerce.com/document/webhooks/" target="_blank" rel="noopener">Webhooks do WooCommerce</a>.</p><h2>O que é Webhook</h2><p>Segundo a <a href="https://pt.wikipedia.org/wiki/Webhook" target="_blank" rel="noopener">Wikipedia</a>, Webhooks são callbacks HTTP definidos pelo utilizador, e isso realmente resume muito bem. Quem está acostumado já em trabalhar com eventos no Javascript por exemplo, entenderá fácil. No WooCommerce, algumas ações como criar ou atualizar um produto e criar um pedido, geram eventos. Nesses eventos, o motor do WooCommerce pode chamar páginas na Web passando algum conteúdo, semelhante no jQuery que quando algo acontece em determinado seletor você chama uma função definida por você. Assim, basta criar uma página que receberá este conteúdo e processar de alguma maneira. Porém, como toda página, ela é aberta publicamente, e alguém com a URL pode tentar enviar dados falsos para ele, por exemplo para dar um desconto de 99% no próprio pedido. Para evitar isso, um dos cabeçalhos enviados para a página contém uma assinatura, que deve ser verificada para confirmar a identidade de quem enviou aquele conteúdo. E é para isso que estamos aqui! Na rede, não consegui encontrar nenhum exemplo prático em PHP, além da documentação atual nessa parte não ajudar muito, e tive um pouco de dificuldade em entender como isso poderia ser feito, então vou compartilhar com vocês o meu método, que é extremamente simples e fácil.</p><h2>Verificando o X-WC-Webhook-Signature</h2><p>O cabeçalho que contém a assinatura se chama X-WC-Webhook-Signature. Para calcularmos o nosso valor para comparar com ele, vamos precisar dos dados do conteúdo e do valor do campo "Segredo" quando cadastramos o Webhook, em Woocommerce &gt; Configurações &gt; API dentro do painel do WordPress.</p><p> </p><figure class="post__image"><img loading="lazy" src="https://dudaskank.com/media/posts/12/webhook-01.png" alt="Webhook do Woocommerce" width="923" height="588" sizes="(max-width: 1920px) 100vw, 1920px" srcset="https://dudaskank.com/media/posts/12/responsive/webhook-01-xs.png 640w, https://dudaskank.com/media/posts/12/responsive/webhook-01-sm.png 768w, https://dudaskank.com/media/posts/12/responsive/webhook-01-md.png 1024w, https://dudaskank.com/media/posts/12/responsive/webhook-01-lg.png 1366w, https://dudaskank.com/media/posts/12/responsive/webhook-01-xl.png 1600w, https://dudaskank.com/media/posts/12/responsive/webhook-01-2xl.png 1920w"><figcaption>Webhook do Woocommerce</figcaption></figure><p>Com esse valor e o conteúdo, precisamos utilizar a função do PHP <a href="http://php.net/manual/pt_BR/function.hash-hmac.php" target="_blank" rel="noopener">hash_hmac</a> e codificar o retorno para base64. Para isso, criei esta função abaixo que faz tudo isso já:</p><pre class="language-php line-numbers"><code>// função para checar se a assinatura bate, retorna true se bate, false se não.
function checkSignature($webhook_signature, $webhook_key, $content) {
  return strcmp($webhook_signature, base64_encode(hash_hmac('sha256', $content, $webhook_key, true))) === 0;
}</code></pre><p>Bem simples e direta, apenas uma linha pra fazer tudo que precisamos. Com isso, já sabemos se podemos confiar no conteúdo enviado ou não. Abaixo, um exemplo bem simples de script, que apenas escreve as informações recebidas e a checagem de assinatura em arquivo:</p><pre class="language-php line-numbers"><code>&lt;?php

// dados enviados pelo woocommerce
$input = file_get_contents('php://input');
// conversão da string em formato json para array associativo
$inputJson = json_decode($input,true);
// assinatura no header
$allHeaders = getallheaders();
$signature = $allHeaders['X-WC-Webhook-Signature'];
// chave secreta, também escolhida no cadastro do webhook do woocommerce
define ('SHARED_SECRET', 'teste edu');

// arquivo para escrever saída de teste
$fp = fopen('out.teste.txt', 'w');
if ($fp !== false) {
  // todos os headers
  $str = 'headers: ' . var_export($allHeaders, true) . PHP_EOL;
  // assinatura
  $str .= 'X-WC-Webhook-Signature: ' . $allHeaders['X-WC-Webhook-Signature'] . PHP_EOL;
  // gera assinatura usando o conteúdo e a chave secreta
  $hashHmac = base64_encode(hash_hmac('sha256', $input, SHARED_SECRET, true));
  $str .= 'hashHmac: ' . $hashHmac . PHP_EOL;
  // checa assinatura usando a função definida ali embaixo
  $check = checkSignature($allHeaders['X-WC-Webhook-Signature'], SHARED_SECRET, $input);
  // resultado da checagem
  $str .= 'assinatura ok? ' . var_export($check, true) . PHP_EOL;
  // conteúdo no formato de array associativo, por exemplo $inputJson['product']['title']
  $str .= 'json: ' . var_export($inputJson, true) . PHP_EOL;
  // escreve o texto no arquivo
  fwrite($fp, $str);
  // fecha arquivo
  fclose($fp);
}

// função para checar se a assinatura bate, retorna true se bate, false se não.
function checkSignature($webhook_signature, $webhook_key, $content) {
  $signed_data = $content;
  $r = strcmp($webhook_signature, base64_encode(hash_hmac('sha256', $signed_data, $webhook_key, true)));
  return  $r === 0;
}</code></pre></div><footer class="content__footer"><div class="entry-wrapper"><p class="content__updated">Artigo atualizado em 23/02/2026</p><div class="content__actions"><ul class="content__tag"><li><a href="https://dudaskank.com/tags/php/">PHP</a></li><li><a href="https://dudaskank.com/tags/webhook/">Webhook</a></li><li><a href="https://dudaskank.com/tags/woocommerce/">WooCommerce</a></li><li><a href="https://dudaskank.com/tags/wordpress/">WordPress</a></li><li><a href="https://dudaskank.com/tags/x-wc-webhook-signature/">X-WC-Webhook-Signature</a></li></ul><div class="content__share"><button class="btn--icon content__share-button js-content__share-button"><svg width="20" height="20" aria-hidden="true"><use xlink:href="https://dudaskank.com/assets/svg/svg-map.svg#share"></use></svg> <span>Compartilhar</span></button><div class="content__share-popup js-content__share-popup"><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fdudaskank.com%2Fwoocommerce-verificando-a-assinatura-no-webhook%2F&amp;via=dudaskank&amp;text=Woocommerce%20-%20Verificando%20a%20assinatura%20no%20Webhook" class="js-share twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://dudaskank.com/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdudaskank.com%2Fwoocommerce-verificando-a-assinatura-no-webhook%2F" class="js-share linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://dudaskank.com/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://api.whatsapp.com/send?text=Woocommerce%20-%20Verificando%20a%20assinatura%20no%20Webhook https%3A%2F%2Fdudaskank.com%2Fwoocommerce-verificando-a-assinatura-no-webhook%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://dudaskank.com/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></div></div><div class="content__bio bio"><div><h3 class="h4 bio__name"><a href="https://dudaskank.com/authors/dudaskank/" rel="author">Dudaskank</a></h3></div></div></div><nav class="content__nav"><div class="wrapper"><div class="content__nav-inner"><div class="content__nav-prev"><a href="https://dudaskank.com/adicionar-vhost-no-xampp/" class="content__nav-link" rel="prev"><figure class="content__nav-image"><img src="https://dudaskank.com/media/posts/11/responsive/Apache_HTTP_server_logo_2016.svg_-2-xs.png" class="lazyload" loading="lazy" alt="" height="335" width="335"></figure><div><span>Anterior</span> Adicionar Vhost no XAMPP</div></a></div><div class="content__nav-next"><a href="https://dudaskank.com/adicionar-rotas-automaticamente-com-arquivo-de-lote-ao-conectar-vpn-usando-o-agendador-de-tarefas/" class="content__nav-link" rel="next"><div><span>Próximo</span> Adicionar rotas automaticamente com arquivo de lote ao conectar VPN usando o Agendador de Tarefas</div></a></div></div></div></nav></footer></article></main><footer class="footer footer--glued"><div class="wrapper"><div class="footer__copyright"><p>Powered by Publii</p></div><button id="backToTop" class="footer__bttop" aria-label="Voltar ao topo" title="Voltar ao topo"><svg width="20" height="20"><use xlink:href="https://dudaskank.com/assets/svg/svg-map.svg#toparrow"/></svg></button></div></footer><script defer="defer" src="https://dudaskank.com/assets/js/scripts.min.js?v=d0fc1030089a37f93a2d51bf6d07565c"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://dudaskank.com/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://dudaskank.com/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://dudaskank.com/media/plugins/syntaxHighlighter/clipboard.min.js"></script><script defer="defer" src="https://dudaskank.com/media/plugins/syntaxHighlighter/prism-copy-to-clipboard.min.js"></script></body></html>